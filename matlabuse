clear
close
clc


y=[121	94	48	25	15	13	5	4	2	1	1	0	0	1	0
];
x=[1	2	3	4	5	6	7	8	9	10	11	12	13	14	15
];

Data1=[x;y];
Data=transpose(Data1);


xbins = Data(:,1);
ycts  = Data(:,2);
pd_poisson  = fitdist(xbins, 'poisson', 'frequency', ycts);
pd_gaussian = fitdist(xbins, 'normal', 'frequency', ycts);
binWidth = xbins(2)-xbins(1);

normConst = sum(ycts)*binWidth;

plot(xbins,ycts,'k*');
hold on; 
plot(xbins, normConst*poisspdf(xbins, pd_poisson.Params(1)));
plot(xbins, normConst*normpdf(xbins, pd_gaussian.Params(1), pd_gaussian.Params(2)), 'r');
hold off;

"""

clear
close
clc


x=[1	2	3	4	5	6	7	8	9	10	11	12	13	14	15
];
y=[121	94	48	25	15	13	5	4	2	1	1	0	0	1	0
];

plot(x,y,'o');
xlabel('x');
ylabel('y');

modelFun =  @(p,x) p(3) .* p(1).p(2)^-3 .*x^2.* exp(-(x.^2)./2.*p(2)^2);
startingVals = [10 2 5];
nlModel = fitnlm(x,y,modelFun,startingVals);
xgrid = linspace(0,20,100)';
line(xgrid,predict(nlModel,xgrid),'Color','r');


clear
close
clc


Q=[9205	8263	6753	19524	24845	1096	1738	8642	11126	2087	8976	33348	8531	3051	678	14050	18645	4395	5160	10902	692	21716	10301	15113	2351	12614	2737	2234	12160	823	143	5461	9130	5019	18469	797	2415	198	17936	5912	7608	13813	6132	12827	18192	8381	6880	3586	2281	2897	11101	7795	10762	7317	7205	26697	568	11061	11609	7286	10113	3983	14080	3172	34192	10907	9143	12069	12022	1899	5688	3864	19626	8155	75522	4006	11323	7200	22739	11773	6269	243	11932	8744	870	1063	10330	2326	4646	558	2033	3303	7246	1827	9713	1354	11501	2671	4526	14794	13556	25729	7996	7022	5431	10354	4461	4177	4587	2499	1048	15358	23955	10527	3875	50018	275	5269	4349	16347	9531	1381	7861	17509	10035	5867	19281	9866	1306	3225	1144	15452	2580	2316	1487	7744	9920	12657	1528	1307	10716	6382	2219	49459	160	13613	31100	13671	11420	4352	2888	8411	1236	29651	21238	3588	20044	246	17048	368	10286	1330	4615	31700	1494	5762	25970	38287	3106	5483	5073	6194	1778	2466	10124	2642	964	19125	22272	3313	8412	12456	5264	36970	6520	1672	4952	3397	8710	865	36442	5358	2595	5538	200	1099	11991	5092	15937	20181	951	4949	2554	8764	1264	9008	3520	1122	5273	8836	6511	12078	4735	8013	7247	15928	27898	3012	8605	8226	25989	13353	1943	8375	5681	8714	40398	7013	9069	3990	6505	453	19537	18548	576	5782	5047	13966	25319	4969	23352	2698	5614	20523	4153	7254	7728	5709	6184	2670	19276	11598	2010	6991	2404	5900	18643	1490	9285	3163	8236	7663	30143	5134	28488	3516	1840	2276	15223	22058	23062	1893	7698	2734	1550	7944	27725	2373	1531	25321	4021	3669	5021	69956	21078	41859	8034	4131	20738	10675	29113	3239	3547	1524	1140	5320	14239	12285	13953	13056	18197	29459	6313	7908	27425	18564	17541	2030	352	3860	1615	9926	351	9455	7023	11499	23804	7243	38009	10044	9349	869	9095	6651	6359	1452	2700	7576	13746	19161	2840
]

binWidth = 5000;
lastVal = ceil(max(Q));
binEdges = 0:binWidth:lastVal+2500;
h = histogram(Q,binEdges);

xlabel('days interval');
ylabel('number');
ylim([0 130]);
counts = histcounts(Q,binEdges);
binCtrs = binEdges(1:end-1) + binWidth/2;
h.FaceColor = [.9 .9 .9];
hold on
plot(binCtrs,counts,'o');
hold off
